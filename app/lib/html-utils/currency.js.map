{"version":3,"file":"currency.js","names":["_lodash","require","_logger","_interopRequireDefault","_CurrencyFormatter","e","__esModule","ownKeys","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","Symbol","iterator","constructor","prototype","_classCallCheck","a","n","TypeError","_defineProperties","configurable","writable","_toPropertyKey","key","_createClass","value","i","_toPrimitive","toPrimitive","call","String","Number","SYMBOLS","CurrencyFormatter","exports","formatSymboled","amount","currency","options","formatter","_get","formatUnsymboled","formatNamed","formatDefault","DEFAULT","isPlainObject","_key","isEmpty","_formatters","_","_create","JSON","stringify","_createStandard","_unused","_createCustom","fSymboled","Intl","NumberFormat","undefined","style","currencyDisplay","fCoded","replace","format","RegExp","concat","logger","info","fDefault"],"sources":["../../../src/lib/html-utils/currency.js"],"sourcesContent":["import { replace, isPlainObject, isEmpty } from 'lodash'\n\nimport logger from '@lib/logger'\n\nconst SYMBOLS = {\n  'WETH': 'Ξ',\n  'WBTC': '₿',\n}\n\nexport class CurrencyFormatter {\n  static #formatters = {}\n  static DEFAULT = ''\n\n  static formatSymboled(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatSymboled(amount)\n  }\n\n  static formatUnsymboled(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatUnsymboled(amount)\n  }\n\n  static formatNamed(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatNamed(amount)\n  }\n\n  static formatDefault(amount, options) {\n    const formatter = CurrencyFormatter.#get(CurrencyFormatter.DEFAULT, options)\n    return formatter.formatUnsymboled(amount)\n  }\n\n  static #get(currency, options) {\n    options = isPlainObject(options) ? options : {}\n    const key = CurrencyFormatter.#key(currency, options)\n    if (isEmpty(CurrencyFormatter.#formatters[key])) {\n      CurrencyFormatter.#formatters[key] = CurrencyFormatter.#create(currency, options)\n    }\n    return CurrencyFormatter.#formatters[key]\n  }\n\n  static #key(currency, options) {\n    return JSON.stringify({ currency, ...options })\n  }\n\n  static #create(currency, options) {\n    try {\n      return CurrencyFormatter.#createStandard(currency, options)\n    } catch {\n      return CurrencyFormatter.#createCustom(currency, options)\n    }\n  }\n\n  static #createStandard(currency, options) {\n    const fSymboled = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency,\n      currencyDisplay: 'narrowSymbol',\n      ...options,\n    })\n\n    const fCoded = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency,\n      currencyDisplay: 'code',\n      ...options,\n    })\n\n    const formatter = {\n      formatUnsymboled: (amount) => replace(fCoded.format(amount), new RegExp(`\\s+${currency}\\s+`), ''),\n      formatSymboled: (amount) => fSymboled.format(amount),\n      formatNamed: (amount) => fCoded.format(amount),\n    }\n\n    logger.info('Standard Currency Formatter Create: \"%s\"', currency)\n\n    return formatter\n\n  }\n\n  static #createCustom(currency, options) {\n    const fDefault = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency: 'USD',\n      currencyDisplay: 'code',\n      ...options,\n    })\n\n    const formatter = {\n      formatUnsymboled: (amount) => replace(fDefault.format(amount), /\\s*[$USD]+\\s*/, ''),\n      formatSymboled: (amount) => replace(fDefault.format(amount), /[$USD]+/, (SYMBOLS[currency] || '')),\n      formatNamed: (amount) => replace(fDefault.format(amount), /[$USD]+/, (currency || '')),\n    }\n\n    logger.info('Custom Currency Formatter Create: \"%s\"', currency || 'DEFAULT')\n\n    return formatter\n\n  }\n\n}\n\n"],"mappings":"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","ignoreList":[]}